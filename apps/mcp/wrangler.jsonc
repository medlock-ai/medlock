{
  "$schema": "node_modules/wrangler/config-schema.json",
  "name": "healthmcp-mcp-server",
  "main": "src/index.ts",
  "compatibility_date": "2025-06-21",
  "compatibility_flags": ["nodejs_compat"],

  /**
   * KV Namespaces for data storage
   */
  "kv_namespaces": [
    {
      "binding": "TOKENS",
      "id": "e1a58b0c701f447fa6b612b57253fcaa",
      "preview_id": "054f9e43724148e5b02ef88e2ded3236",
    },
    {
      "binding": "AUDIT",
      "id": "17cf1513be614f7bad48dec0313750ba",
      "preview_id": "8d057aae43c94933966a8939d7381d7a",
    },
  ],

  /**
   * Durable Objects for rate limiting and MCP agents
   */
  "durable_objects": {
    "bindings": [
      {
        "name": "RATE_LIMITER",
        "class_name": "RateLimiter",
      },
      {
        "name": "MCP_AGENT",
        "class_name": "HealthMcpAgent",
      },
    ],
  },

  /**
   * Migrations for SQLite-enabled Durable Objects
   */
  "migrations": [
    {
      "tag": "v1",
      "new_sqlite_classes": ["HealthMcpAgent", "RateLimiter"],
    },
  ],

  /**
   * Custom domain routing
   */
  "routes": [
    {
      "pattern": "api.healthmcp.ai",
      "custom_domain": true,
    },
  ],

  /**
   * Environment variables
   */
  "vars": {
    "MCP_VERSION": "v0.1.0",
    "ALLOWED_ORIGINS": "https://healthmcp.ai,https://chat.openai.com,https://claude.ai",
    "SOLID_POD_DOMAIN": "storage.solidpod.com",
  },

  /**
   * Development settings
   */
  "dev": {
    "port": 8788,
    "local_protocol": "https",
    "upstream_protocol": "https",
  },

  /**
   * Observability
   */
  "observability": {
    "enabled": true,
  },

  /**
   * Staging environment
   */
  "env": {
    "staging": {
      "name": "healthmcp-mcp-staging",
      "routes": [
        {
          "pattern": "api-staging.healthmcp.ai",
          "custom_domain": true,
        },
      ],
      "vars": {
        "MCP_VERSION": "v0.1.0-staging",
      },
    },
  },
}
